<!DOCTYPE html>
<html lang="en" class="yui-overrride">
<head>
    <meta charset="utf-8">
    <title>packages/bricksui-form/lib/bu-editor.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            <h1 class="blue-main-title"></h1>
        </div>
        <div class="yui3-u-1-4 version project-version">
            API Docs for: 
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/BricksUI.html">BricksUI</a></li>
            
                <li><a href="../classes/BricksUI.BuTabs.html">BricksUI.BuTabs</a></li>
            
                <li><a href="../classes/BricksUI.ENV.html">BricksUI.ENV</a></li>
            
                <li><a href="../classes/BricksUI.I18n.html">BricksUI.I18n</a></li>
            
                <li><a href="../classes/BricksUI.I18n.I18nableValidationMixin.html">BricksUI.I18n.I18nableValidationMixin</a></li>
            
                <li><a href="../classes/BricksUI.I18n.lang.html">BricksUI.I18n.lang</a></li>
            
                <li><a href="../classes/BricksUI.StateHandler.html">BricksUI.StateHandler</a></li>
            
                <li><a href="../classes/Ember.BuDatePicker.html">Ember.BuDatePicker</a></li>
            
                <li><a href="../classes/Ember.BuEditor.html">Ember.BuEditor</a></li>
            
                <li><a href="../classes/Ember.EasyForm.html">Ember.EasyForm</a></li>
            
                <li><a href="../classes/Ember.EasyForm.Checkbox.html">Ember.EasyForm.Checkbox</a></li>
            
                <li><a href="../classes/Ember.EasyForm.Config.html">Ember.EasyForm.Config</a></li>
            
                <li><a href="../classes/Ember.EasyForm.Radio.html">Ember.EasyForm.Radio</a></li>
            
                <li><a href="../classes/Ember.EasyForm.Select.html">Ember.EasyForm.Select</a></li>
            
                <li><a href="../classes/Ember.I18n.html">Ember.I18n</a></li>
            
                <li><a href="../classes/Ember.Validations.html">Ember.Validations</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/bricksui.html">bricksui</a></li>
            
                <li><a href="../modules/bricksui-form.html">bricksui-form</a></li>
            
                <li><a href="../modules/bricksui-i18n.html">bricksui-i18n</a></li>
            
                <li><a href="../modules/bricksui-metal.html">bricksui-metal</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: packages/bricksui-form/lib/bu-editor.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
var get = Ember.get, set = Ember.set;

/**
 @module bricksui
 @submodule bricksui-form
 */
/**
 基于ember与[百度富文本编辑器umeditor](http://ueditor.baidu.com/website/umeditor.html)
 主要增加了数据绑定的功能，config配置项与umeditor一致
 继承自Ember.Component，用法上与Ember.Component保持一致
 使用方式如:
 &#x60;&#x60;&#x60;handlebars
 {{bu-editor value=title valueType=&quot;contentTxt&quot;}}
 &#x60;&#x60;&#x60;
 @class BuEditor
 @namespace Ember
 @extends Ember.Component
 @uses Ember.TextSupport
 */
var BuEditor = Ember.Component.extend({

  /**
   value类型，分别为content和contentTxt,content包含其中的段落标签,contentTxt则指纯文本内容
   @property valueType
   @type string
   @default &quot;content&quot;
   */
  valueType: &quot;content&quot;,

  _valueHandler: {
    content: function (editor) {
      return editor.getContent();
    },
    contentTxt: function (editor) {
      return editor.getContentTxt();
    }
  },


  /**
   用户配置文件
   @property options
   @type object
   */
  options: {},

  /**
   富文本框默认配置文件
   @property defaultSetting
   @type object
   */
  defaultOptions: {
    //这里可以选择自己需要的工具按钮名称
    toolbar: [&#x27;fullscreen undo redo bold italic underline&#x27;],
    //focus时自动清空初始化时的内容
    autoClearinitialContent: true,
    //关闭字数统计
    wordCount: false,
    //关闭elementPath
    elementPathEnabled: false,
    //默认的编辑区域高度
    initialFrameHeight: 300
    //更多其他参数，请参考umeditor.config.js中的配置项
  },


  /**
   绑定到文本域的字段
   @property value
   @type String
   @default null
   */
  value: &quot;&quot;,

  /**
   占位符编号，可根据该编号取得全局唯一编辑器实例
   @property holderId
   @type String
   @default bu-editor+父级ID编号
   */
  holderId: function () {
    return &#x27;bu-editor&#x27; + Ember.get(this, &#x27;elementId&#x27;);
  }.property(&#x27;elementId&#x27;),

  /**
   为UMeditor添加事件监听
   @private
   @method _attachEvent
   @param editor UMeditor实例
   */
  _attachEvent: function (editor) {

    editor.addListener(&#x27;ready&#x27;, function () {
      var value = get(this, &#x27;value&#x27;);
      if (!Ember.isEmpty(value)) editor.setContent(value);

      this.$(&#x27;.edui-container&#x27;).css({width: &#x27;100%&#x27;});

    }.bind(this));

    editor.addListener(&#x27;contentChange&#x27;, function () {
      var
        value = get(this, &#x27;value&#x27;),
        elementValue = this._valueHandler[this.valueType](this._editor);

      if (value !== elementValue) this._updateValue(elementValue);

    }.bind(this));

  },

  _updateElementValue: Ember.observer(&#x27;value&#x27;, function () {
    // We do this check so cursor position doesn&#x27;t get affected in IE
    var value = get(this, &#x27;value&#x27;),
      elementValue = this._valueHandler[this.valueType](this._editor);

    if (elementValue !== value) this._editor.setContent(value);

  }),


  /**
   将textarea转换为UMeditor实例
   @private
   @method _updateDom
   */
  _updateDom: function () {
    var
      options = get(this, &#x27;options&#x27;),
      defaultOptions = get(this, &#x27;defaultOptions&#x27;),
      editor;

    if (typeof options === &#x27;string&#x27;) {
      options = JSON.parse(options);
    }
    //TODO toolbar属性合并
    options = $.extend(true, {}, options, defaultOptions);

    editor = this._editor = UM.getEditor(this.get(&#x27;holderId&#x27;), options);

    this._attachEvent(editor);
  }.on(&#x27;didInsertElement&#x27;),


  /**
   在富文本框编辑器内容发生改变时同步value值
   @private
   @method _updateValue
   @param value 富文本编辑器改变后的值
   */
  _updateValue: function (value) {
    set(this, &#x27;value&#x27;, value);
  },


  /**
   销毁富文本编辑器，销毁组件
   @private
   @method _destroyEditor
   */
  _destroyEditor: function () {
    this._editor.destroy();
    this._editor = null;
  }.on(&#x27;willDestroyElement&#x27;)
});

export default BuEditor;

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
